@page
@model CasinoDeYann.Pages.GoldMine

@{
    ViewData["Title"] = "Mine d'or";
    <link rel="stylesheet" href="~/css/GoldMine.css" asp-append-version="true"/>
}

<div class="goldmine-container">
    <img
        src="~/assets/GoldMine/machine/machine.png"
        alt="Gold Mine"
        class="goldmine-gif"
    />
    <div class="nugget-wrapper" id="nugget-wrapper">
        <img
            src="~/assets/GoldMine/nugget/nugget.png"
            alt="Gold Nugget"
            class="nugget"
            id="nugget"
        />
    </div>
    
    <button id="spin" type="button"></button>

</div>

@section Scripts {
    <script>
        const nugget = document.getElementById("nugget");
        const button = document.getElementById("spin");

        button.addEventListener("click", async () => {
            nugget.classList.add("shake");
            const res = await fetch("/api/GoldMine/mine", {method: "POST"});

            const moneyDisplay = document.getElementById("user-money");
            const amount = parseInt(moneyDisplay.textContent);
            
            if (amount < 100) {
                moneyDisplay.textContent = String(amount + 1);
            }
            
            setTimeout(() => {
                nugget.classList.remove("shake");
            }, 300);
        });
    </script>
}
